<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Poulpain Shop - Mega Booster Pack Magic</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap');
    body {
      margin: 0;
      background-color: #0b0b0b;
      font-family: 'Poppins', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
      color: #eee;
      min-height: 100vh;
    }
    .main-logo {
      width: 350px;
      margin-bottom: 50px;
      box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      transition: transform 0.4s ease;
      cursor: pointer;
    }
    .main-logo:hover {
      transform: scale(1.05);
    }
    .container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 60px;
    }
    .logo {
      width: 90px;
      transition: transform 0.3s ease;
      cursor: pointer;
      filter: brightness(1.1);
    }
    .logo:hover {
      transform: scale(1.2);
      filter: brightness(1.4);
    }
    .produit {
      background: linear-gradient(135deg, #111111, #222222);
      padding: 30px 35px;
      border-radius: 18px;
      max-width: 430px;
      text-align: center;
      box-shadow: 0 0 40px rgba(255, 215, 0, 0.4);
      position: relative;
    }
    .produit img {
      max-width: 280px;
      border-radius: 16px;
      margin-bottom: 20px;
      box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
      user-select: none;
    }
    .titre-produit {
      font-size: 1.8rem;
      font-weight: 700;
      color: #ffd700;
      margin-bottom: 15px;
      letter-spacing: 1.2px;
      text-shadow: 0 0 8px #ffd700cc;
      user-select: none;
    }
   .prix {
  font-size: 1.8rem; /* r√©duit de 2rem √† 1.8rem */
  color: #f0e6d2; /* beige clair, plus lisible sur jaune */
  font-weight: bold;
  animation: pulse 2s infinite;
  margin-bottom: 15px;
}
    @keyframes pulse {
      0%, 100% { text-shadow: 0 0 25px #ffd700cc; }
      50% { text-shadow: 0 0 40px #fff700dd; }
    }
    .frais-port {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-size: 1.1rem;
      font-weight: 700;
      color: #ffcc00cc;
      background: rgba(255, 215, 0, 0.12);
      padding: 12px 18px;
      border-radius: 12px;
      margin-bottom: 25px;
      box-shadow: 0 0 12px #ffd700aa;
      user-select: none;
    }
    .frais-port svg {
      width: 22px;
      height: 22px;
      fill: #ffd700;
      filter: drop-shadow(0 0 2px #ffd700);
      user-select: none;
    }
    .msg-livraison {
      margin-top: -15px;
      margin-bottom: 25px;
      font-weight: 600;
      font-size: 1rem;
      color: #fff;
      min-height: 24px;
      user-select: none;
    }
    .description {
      text-align: left;
      white-space: pre-line;
      margin-bottom: 20px;
      font-size: 15px;
      line-height: 1.5;
      color: #ddd;
      user-select: none;
    }
    .description ul {
      margin-left: 22px;
      padding-left: 0;
      color: #ffe;
      list-style: inside disc;
      font-size: 15px;
      margin-bottom: 15px;
    }
    label {
      font-weight: 700;
      color: #ffd700cc;
      user-select: none;
    }
    input[type=number] {
      width: 65px;
      padding: 7px 10px;
      margin-left: 12px;
      margin-right: 18px;
      border-radius: 8px;
      border: none;
      text-align: center;
      font-weight: 700;
      font-size: 1.1rem;
      color: #111;
      transition: box-shadow 0.3s ease;
    }
    input[type=number]:focus {
      outline: none;
      box-shadow: 0 0 10px #ffd700cc;
    }
    button {
      cursor: pointer;
      background-color: #ffd700;
      border: none;
      border-radius: 10px;
      padding: 14px 35px;
      font-weight: 900;
      font-size: 1.2rem;
      color: #1a1a1a;
      box-shadow: 0 6px 15px rgba(255, 215, 0, 0.7);
      transition: background-color 0.35s ease, box-shadow 0.35s ease;
      user-select: none;
    }
    button:hover:not(:disabled) {
      background-color: #fff244;
      box-shadow: 0 8px 20px rgba(255, 235, 0, 0.9);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    p.stock {
      margin-top: 20px;
      font-weight: 600;
      color: #ccc;
      font-size: 1rem;
      user-select: none;
    }
    #panier {
      margin-top: 40px;
      background: #222;
      padding: 25px 30px;
      border-radius: 18px;
      max-width: 420px;
      color: #eee;
      box-shadow: 0 0 40px #ffd70099;
      display: none;
      user-select: none;
    }
    #panier h3 {
      margin-top: 0;
      color: #ffd700;
      font-weight: 700;
      font-size: 1.8rem;
      text-align: center;
      text-shadow: 0 0 6px #ffd700cc;
      user-select: none;
    }
    #panier p {
      font-size: 1.1rem;
      margin: 8px 0;
      text-align: center;
    }
    #viderPanierBtn {
      background-color: #c0392b;
      color: white;
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      font-weight: 700;
      font-size: 1rem;
      border-radius: 12px;
      box-shadow: 0 5px 15px #c0392bcc;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    #viderPanierBtn:hover {
      background-color: #e74c3c;
      box-shadow: 0 6px 20px #e74c3ccc;
    }
    #paypal-button-container {
      margin-top: 20px;
    }
  </style>

  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=AbbM0FEMw_rXOuQ2anllZLqSYikCEsNHG8tw2r-M1J6nkPSHGAFmrSktz6as7AFyomgaMO_MxefyP1dP&currency=EUR"></script>
</head>
<body>

  <!-- Logo principal -->
  <img src="ton-logo.png" alt="Logo principal Poulpain Shop" class="main-logo" tabindex="0" />

  <!-- Section bienvenue -->
  <section aria-label="Bienvenue" style="margin-bottom: 40px; text-align: center; font-size: 20px; font-weight: 700; color: #ffd700;">
    Bienvenue sur <strong>Poulpain Shop</strong>, retrouvez-moi √©galement sur :
  </section>

  <!-- Logos secondaires -->
  <div class="container" aria-label="Liens vers autres plateformes">
    <a href="https://lien1.com" target="_blank" aria-label="Lien vers plateforme 1"><img src="logo1.png" class="logo" alt="Logo plateforme 1" tabindex="0" /></a>
    <a href="https://lien2.com" target="_blank" aria-label="Lien vers plateforme 2"><img src="logo2.png" class="logo" alt="Logo plateforme 2" tabindex="0" /></a>
    <a href="https://www.ebay.com/usr/poulpain" target="_blank" aria-label="Lien vers eBay Poulpain"><img src="logo3.png" class="logo" alt="Logo eBay Poulpain" tabindex="0" /></a>
  </div>

  <!-- Produit -->
  <article class="produit" aria-label="Produit Mega Booster Pack Magic">
    <h2 class="titre-produit">Mega Booster Pack Magic - 50 cartes</h2>
    <img src="mega-booster.jpg" alt="Mega Booster Pack Magic" loading="lazy" />

    <p class="prix" aria-label="Prix du produit 7 euros">7,50 ‚Ç¨</p>

    <div class="frais-port" aria-live="polite" aria-atomic="true" role="region">
      <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24"><path d="M20 8h-3V4h-2v4H9V4H7v4H4v9h16v-9zm-6 5a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/></svg>
      <span id="texteFraisPort">Frais de port : 2,99 ‚Ç¨ (offerts d√®s 4 packs)</span>
    </div>
    <p id="msgLivraisonGratuite" class="msg-livraison" aria-live="polite" aria-atomic="true"></p>

    <p class="description">
      Booste ton exp√©rience Magic avec ce pack !<br />
      Chaque booster contient 50 cartes (des s√©ries de 2005 √† 2025) :
    </p>
    <ul class="description">
      <li>üü¶ 30 cartes communes</li>
      <li>üü™ 15 cartes uncos</li>
      <li>üü® 5 cartes rares ou mythiques garanties</li>
      <li>üîÅ Aucun doublon</li>
    </ul>
    <p class="description">
      üìå √âtat : bon √† tr√®s bon | üìö Langue : FR
    </p>
    <p class="description">
      +2 boosters ? ‚Üí 1 carte rare ou mythique offerte par booster suppl√©mentaire.
    </p>

    <p class="stock" aria-live="polite">Stock restant : <span id="stockRestant">...</span></p>

    <form id="formProduit" aria-label="Formulaire d'ajout au panier" onsubmit="return false;">
      <label for="quantite">Quantit√© :</label>
      <input
        type="number"
        id="quantite"
        name="quantite"
        min="1"
        value="1"
        aria-describedby="msgErreurQuantite"
        aria-required="true"
      />
      <span id="msgErreurQuantite" role="alert" style="color:#ff6666; display:none; font-weight:700; margin-left: 10px;"></span>
      <button id="ajouterBtn" type="submit" aria-label="Ajouter au panier">Ajouter au panier</button>
    </form>
  </article>

  <!-- Panier -->
  <section id="panier" aria-live="polite" aria-atomic="true" role="region" aria-label="Panier d'achat">
    <h3>Panier</h3>
    <p>Produit : Mega Booster Pack Magic</p>
    <p>Quantit√© : <span id="panierQte">0</span></p>
    <p>Total : <span id="panierTotal">0</span> ‚Ç¨</p>
    <button id="viderPanierBtn" aria-label="Vider le panier">Vider le panier</button>
    <div id="paypal-button-container"></div>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, doc, getDoc, runTransaction } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCuh-opgGC3rha5j4ptxrZ1RByrx2sV1mA",
      authDomain: "mega-booster-656e5.firebaseapp.com",
      projectId: "mega-booster-656e5",
      storageBucket: "mega-booster-656e5.appspot.com",
      messagingSenderId: "568395965944",
      appId: "1:568395965944:web:cc490bb3ef04f67b9a220d",
      measurementId: "G-0M0FZCRTCJ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let stock = 0;
    let panierQte = 0;
    const prixUnitaire = 7;
    const fraisPortStandard = 2.99;
    const livraisonGratuiteMin = 4;

    const stockSpan = document.getElementById('stockRestant');
    const quantiteInput = document.getElementById('quantite');
    const ajouterBtn = document.getElementById('ajouterBtn');
    const panierDiv = document.getElementById('panier');
    const panierQteSpan = document.getElementById('panierQte');
    const panierTotalSpan = document.getElementById('panierTotal');
    const viderPanierBtn = document.getElementById('viderPanierBtn');
    const paypalContainer = document.getElementById('paypal-button-container');
    const msgErreurQuantite = document.getElementById('msgErreurQuantite');
    const msgLivraison = document.getElementById('msgLivraisonGratuite');
    const texteFraisPort = document.getElementById('texteFraisPort');

    async function chargerStock() {
      const docRef = doc(db, 'produit', 'mega_booster_pack');
      const docSnap = await getDoc(docRef);
      if (docSnap.exists()) {
        stock = docSnap.data().stock;
        stockSpan.textContent = stock;
        quantiteInput.max = stock;
        ajouterBtn.disabled = stock === 0;
        if (stock === 0) {
          msgLivraison.textContent = "Rupture de stock, revenez bient√¥t !";
        } else {
          majMessageLivraison();
        }
      } else {
        stockSpan.textContent = "N/A";
        ajouterBtn.disabled = true;
        msgLivraison.textContent = "Impossible de charger le stock.";
      }
    }

    function calculFraisPort(qte) {
      return qte >= livraisonGratuiteMin ? 0 : fraisPortStandard;
    }

    function majMessageLivraison() {
      if (panierQte >= livraisonGratuiteMin) {
        msgLivraison.textContent = "üéâ Livraison gratuite appliqu√©e !";
        texteFraisPort.textContent = "Frais de port : Offerts d√®s 4 packs üéâ";
      } else {
        const restant = livraisonGratuiteMin - panierQte;
        msgLivraison.textContent = `Ajoutez ${restant} pack${restant > 1 ? 's' : ''} pour la livraison gratuite !`;
        texteFraisPort.textContent = `Frais de port : ${fraisPortStandard.toFixed(2)} ‚Ç¨ (offerts d√®s 4 packs)`;
      }
    }

    function majAffichagePanier() {
      if (panierQte > 0) {
        panierDiv.style.display = 'block';
        panierQteSpan.textContent = panierQte;
        const fraisPort = calculFraisPort(panierQte);
        const total = panierQte * prixUnitaire + fraisPort;
        panierTotalSpan.textContent = total.toFixed(2);
        majMessageLivraison();
        configurerPayPal();
      } else {
        panierDiv.style.display = 'none';
        paypalContainer.innerHTML = '';
        msgLivraison.textContent = "";
        texteFraisPort.textContent = `Frais de port : ${fraisPortStandard.toFixed(2)} ‚Ç¨ (offerts d√®s 4 packs)`;
        msgErreurQuantite.style.display = 'none';
      }
    }

    async function reduireStockApresPaiement(qte) {
      const docRef = doc(db, 'produit', 'mega_booster_pack');
      try {
        await runTransaction(db, async (transaction) => {
          const docSnap = await transaction.get(docRef);
          if (!docSnap.exists()) throw "Produit non trouv√© !";
          const stockActuel = docSnap.data().stock;
          if (stockActuel < qte) throw "Stock insuffisant !";
          transaction.update(docRef, { stock: stockActuel - qte });
        });
        stock -= qte;
        stockSpan.textContent = stock;
        quantiteInput.max = stock;
        if (stock === 0) {
          ajouterBtn.disabled = true;
          msgLivraison.textContent = "Rupture de stock, revenez bient√¥t !";
        }
      } catch (e) {
        alert("Erreur lors de la mise √† jour du stock : " + e);
      }
    }

    // Validation quantit√© + ajout panier
    ajouterBtn.addEventListener('click', () => {
      const qteChoisie = parseInt(quantiteInput.value);
      if (isNaN(qteChoisie) || qteChoisie < 1) {
        msgErreurQuantite.textContent = "Veuillez entrer une quantit√© valide (‚â•1).";
        msgErreurQuantite.style.display = 'inline';
        return;
      }
      if (qteChoisie > stock) {
        msgErreurQuantite.textContent = `Stock insuffisant, max ${stock}.`;
        msgErreurQuantite.style.display = 'inline';
        return;
      }
      msgErreurQuantite.style.display = 'none';
      panierQte += qteChoisie;
      if (panierQte > stock) panierQte = stock;
      majAffichagePanier();
    });

    viderPanierBtn.addEventListener('click', () => {
      panierQte = 0;
      majAffichagePanier();
    });

    // PayPal Buttons
    function configurerPayPal() {
      paypalContainer.innerHTML = '';
      if (panierQte === 0) return;

      paypal.Buttons({
        style: {
          shape: 'pill',
          color: 'gold',
          layout: 'vertical',
          label: 'pay',
        },
        createOrder: function(data, actions) {
          const fraisPort = calculFraisPort(panierQte);
          const total = panierQte * prixUnitaire + fraisPort;
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: total.toFixed(2),
                currency_code: 'EUR',
                breakdown: {
                  item_total: { value: (panierQte * prixUnitaire).toFixed(2), currency_code: 'EUR' },
                  shipping: { value: fraisPort.toFixed(2), currency_code: 'EUR' }
                }
              },
              items: [{
                name: 'Mega Booster Pack Magic',
                unit_amount: { value: prixUnitaire.toFixed(2), currency_code: 'EUR' },
                quantity: panierQte.toString(),
                category: "PHYSICAL_GOODS"
              }]
            }]
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            alert('Merci pour votre achat, ' + details.payer.name.given_name + ' !');
            reduireStockApresPaiement(panierQte);
            panierQte = 0;
            majAffichagePanier();
          });
        },
        onError: function(err) {
          alert('Une erreur est survenue lors du paiement : ' + err);
        }
      }).render('#paypal-button-container');
    }

    // Initialisation
    chargerStock();
    majAffichagePanier();
  </script>
<!-- Section Commentaires -->
<section aria-label="Commentaires" style="margin-top: 60px; max-width: 430px; width: 100%; background: #1a1a1a; padding: 25px 30px; border-radius: 18px; box-shadow: 0 0 30px #ffd70055;">
  <h3 style="color: #ffd700; font-size: 1.6rem; text-align: center; margin-bottom: 20px;">Laissez un avis ‚≠ê</h3>
  
  <form id="commentForm" style="display: flex; flex-direction: column; gap: 15px;">
    <label for="pseudo">Votre pr√©nom :</label>
    <input type="text" id="pseudo" name="pseudo" required style="padding: 10px; border-radius: 8px; border: none; font-size: 1rem;">

    <label for="note">Votre note :</label>
    <div id="note" style="display: flex; gap: 8px; font-size: 1.5rem; cursor: pointer;">
      <span class="etoile" data-note="1">‚òÜ</span>
      <span class="etoile" data-note="2">‚òÜ</span>
      <span class="etoile" data-note="3">‚òÜ</span>
      <span class="etoile" data-note="4">‚òÜ</span>
      <span class="etoile" data-note="5">‚òÜ</span>
    </div>

    <label for="commentaire">Votre commentaire :</label>
    <textarea id="commentaire" name="commentaire" rows="4" required style="padding: 10px; border-radius: 8px; border: none; font-size: 1rem;"></textarea>

    <button type="submit">Envoyer</button>
  </form>

  <div id="listeCommentaires" style="margin-top: 30px;">
    <h4 style="color: #ffd700;">Avis r√©cents :</h4>
    <ul id="commentaires" style="list-style: none; padding-left: 0; margin-top: 10px;"></ul>
  </div>
</section>

  <script>
  let noteActuelle = 0;

  const etoiles = document.querySelectorAll('.etoile');
  const commentaires = document.getElementById('commentaires');

  etoiles.forEach((etoile, index) => {
    etoile.addEventListener('mouseover', () => {
      colorierEtoiles(index + 1);
    });
    etoile.addEventListener('mouseout', () => {
      colorierEtoiles(noteActuelle);
    });
    etoile.addEventListener('click', () => {
      noteActuelle = index + 1;
      colorierEtoiles(noteActuelle);
    });
  });

  function colorierEtoiles(note) {
    etoiles.forEach((e, i) => {
      e.textContent = i < note ? '‚òÖ' : '‚òÜ';
      e.style.color = i < note ? '#ffd700' : '#999';
    });
  }

  document.getElementById('commentForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const pseudo = document.getElementById('pseudo').value.trim();
    const commentaire = document.getElementById('commentaire').value.trim();

    if (noteActuelle === 0 || pseudo === "" || commentaire === "") {
      alert("Merci de remplir tous les champs et de noter avec au moins 1 √©toile.");
      return;
    }

    const li = document.createElement('li');
    li.innerHTML = `<strong style="color:#ffd700">${pseudo}</strong> (${'‚òÖ'.repeat(noteActuelle)}${'‚òÜ'.repeat(5 - noteActuelle)})<br><span style="color:#ddd">${commentaire}</span><hr style="margin:10px 0; border-color: #444;">`;
    commentaires.prepend(li);

    // R√©initialisation
    document.getElementById('commentForm').reset();
    noteActuelle = 0;
    colorierEtoiles(0);
  });
</script>

</body>
</html>
